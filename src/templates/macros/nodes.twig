{% macro renderRecursive(nodes) %}
    {% import _self as self %}
    {% import 'macros/field.twig' as fieldMacro %}

    {% for node in nodes %}
        {% if node.isFieldset %}
            <fieldset>
                {% if node.getLegendText %}
                    <legend>{{ node.getLegendText }}</legend>
                {% endif %}
                {{ self.renderRecursive(node.getNodes) }}
            </fieldset>
        {% else %}
            {{ fieldMacro.render(node) }}
        {% endif %}
    {% endfor %}

{% endmacro %}